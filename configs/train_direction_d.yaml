# Complete training configuration for PINN - Direction D: Backbone + 3 Heads
# Dependency-Aware Single Model

model:
  type: direction_d  # Backbone + 3 Dependency-Aware Heads architecture
  
  # Feature encoding
  fourier_features: 8              # Number of Fourier frequencies (K)
  context_embedding_dim: 32        # Dimension of context embedding
  
  # Shared backbone
  backbone_hidden_dims: [256, 256, 256, 256]  # Hidden dimensions for backbone MLP
  
  # Head architectures
  head_g3_hidden_dims: [128, 64]              # Mass head (G3)
  head_g2_hidden_dims: [256, 128, 64]         # Attitude head (G2)
  head_g1_hidden_dims: [256, 128, 128, 64]    # Translation head (G1)
  
  # Activation and regularization
  activation: gelu                 # Activation function (gelu recommended)
  layer_norm: true               # Use layer normalization
  dropout: 0.0                   # Dropout rate (0.0 recommended for Direction D)

train:
  experiment_name: direction_d_baseline
  batch_size: 8
  num_workers: 0
  epochs: 100
  learning_rate: 1e-3
  weight_decay: 1e-5
  time_subsample: null  # Full time grid
  
  # Early stopping
  early_stopping_patience: 10
  early_stopping_min_delta: 0.0
  
  # Learning rate scheduler
  scheduler:
    type: cosine
    kwargs:
      T_max: 100
      eta_min: 1e-6

# Loss configuration
loss:
  lambda_data: 1.0
  lambda_phys: 0.1
  lambda_bc: 1.0
  lambda_phys_final: 1.0
  homotopy_schedule: linear  # linear | exponential | fixed

# Physics and scaling configs
physics_config: configs/phys.yaml
scales_config: configs/scales.yaml


